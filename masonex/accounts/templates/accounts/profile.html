{% extends 'accounts/form.html' %}
{% load static helpers accounts_tags %}

{% if messages or not user.bio %}
{% block messages %}
<ul class="list-unstyled mb-0">
  {% if not user.bio %}
  <li>{% alert style="secondary" content="Your bio is missing." %}</li>
  {% endif %}
  {% if messages %}
  {% for message in messages %}
  <li>{% alert style=message.tags content=message %}</li>
  {% endfor %}
  {% endif %}
</ul>
{% endblock messages %}
{% endif %}

{% block form_content %}
<section class="d-flex gap-2 mb-2">
  <div>
    <div class="dropdown">
      <a href="#" class="dropdown-toggle" id="avatar" data-bs-toggle="dropdown" aria-expanded="false">
        {% user_avatar css_class='d-block rounded scale-in picture-scale-in' width='3.5em' %}
      </a>
      <ul class="dropdown-menu shadow mt-1">
        {% if user.avatar %}
        <li>
          <a href="{{ request.user.avatar.url }}" target="_blank" class="dropdown-item">
            <i class="ti ti-photo"></i> Open photo
          </a>
        </li>
        {% endif %}
        <li>
          <label for="{{ form.avatar.id_for_label }}" class="dropdown-item cursor-pointer">
            <i class="ti ti-photo-edit"></i>
            {{ form.avatar.label }}
            {{ form.avatar }}
          </label>
        </li>
        {% if user.avatar %}
        <li>
          <a href="#" class="dropdown-item text-danger" data-bs-toggle="modal" data-bs-target="#avatarDeleteModal">
            <i class="ti ti-trash"></i> Delete photo
          </a>
        </li>
        {% endif %}
      </ul>
    </div>
    {% url 'accounts:user_avatar_delete' as avatar_delete_url %}
    {% delete_confirm_modal object_name='avatar' delete_url=avatar_delete_url %}
  </div>
  <hgroup>
    <h2 class="mb-1 fs-base">{{ user.get_full_name }}</h2>
    <p class="mb-0 text-muted lh-sm fs-sm">Provide basic information to make using Masonex more convenient</p>
  </hgroup>
</section>
<section class="mb-3">
  <div class="row mb-1">
    <div class="col-6">
      <label for="{{ form.first_name.id_for_label }}" class="form-label">{{ form.first_name.label }}</label>
      {{ form.first_name }}
    </div>
    <div class="col-6">
      <label for="{{ form.last_name.id_for_label }}" class="form-label">{{ form.last_name.label }}</label>
      {{ form.last_name }}
    </div>
  </div>
  <div class="col-12">
    <label for="{{ form.bio.id_for_label }}" class="form-label">{{ form.bio.label }}</label>
    {{ form.bio }}
  </div>
</section>
<section class="mb-1">
  <ul class="list-group">
    <li class="list-group-item flush-control">
      <hgroup class="flush-control-body">
        <h6 class="form-label">Email</h6>
        <p class="flush-control-text fs-sm user-select-all">{{ request.user.email|truncatemail:2 }}</p>
      </hgroup>
      <a href="{% url 'accounts:email_change' %}" class="btn btn-secondary">Edit</a>
    </li>
    <li class="list-group-item flush-control">
      <hgroup class="flush-control-body">
        <h6 class="form-label">Password</h6>
        <p class="flush-control-text fs-sm">∗∗∗∗∗∗∗∗</p>
      </hgroup>
      <a href="{% url 'accounts:password_change' %}" class="btn btn-secondary">Edit</a>
    </li>
  </ul>
</section>
{% endblock form_content %}
